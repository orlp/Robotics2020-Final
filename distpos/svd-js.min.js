!function(r,f){"object"==typeof exports&&"undefined"!=typeof module?f(exports):"function"==typeof define&&define.amd?define(["exports"],f):f((r=r||self).SVDJS={})}(this,function(r){"use strict";r.SVD=function(r,f,o,t,e){if(f=void 0===f||f,o=void 0===o||o,e=1e-64/(t=t||Math.pow(2,-52)),!r)throw new TypeError("Matrix a is not defined");var a,i,n,s,h,M,l,d,p,u,b,w,q,v=r[0].length,y=r.length;if(y<v)throw new TypeError("Invalid matrix: m < n");var c=[],x=[],m=[];for(a=b=d=0;a<y;a++)x[a]=new Array(v).fill(0);for(a=0;a<v;a++)m[a]=new Array(v).fill(0);var S,k=new Array(v).fill(0);for(a=0;a<y;a++)for(i=0;i<v;i++)x[a][i]=r[a][i];for(a=0;a<v;a++){for(c[a]=d,u=0,s=a+1,i=a;i<y;i++)u+=Math.pow(x[i][a],2);if(u<e)d=0;else for(p=(l=x[a][a])*(d=l<0?Math.sqrt(u):-Math.sqrt(u))-u,x[a][a]=l-d,i=s;i<v;i++){for(u=0,n=a;n<y;n++)u+=x[n][a]*x[n][i];for(l=u/p,n=a;n<y;n++)x[n][i]=x[n][i]+l*x[n][a]}for(k[a]=d,u=0,i=s;i<v;i++)u+=Math.pow(x[a][i],2);if(u<e)d=0;else{for(p=(l=x[a][a+1])*(d=l<0?Math.sqrt(u):-Math.sqrt(u))-u,x[a][a+1]=l-d,i=s;i<v;i++)c[i]=x[a][i]/p;for(i=s;i<y;i++){for(u=0,n=s;n<v;n++)u+=x[i][n]*x[a][n];for(n=s;n<v;n++)x[i][n]=x[i][n]+u*c[n]}}b<(w=Math.abs(k[a])+Math.abs(c[a]))&&(b=w)}if(o)for(a=v-1;0<=a;a--){if(0!==d){for(p=x[a][a+1]*d,i=s;i<v;i++)m[i][a]=x[a][i]/p;for(i=s;i<v;i++){for(u=0,n=s;n<v;n++)u+=x[a][n]*m[n][i];for(n=s;n<v;n++)m[n][i]=m[n][i]+u*m[n][a]}}for(i=s;i<v;i++)m[a][i]=0,m[i][a]=0;m[a][a]=1,d=c[a],s=a}if(f)for(a=v-1;0<=a;a--){for(s=a+1,d=k[a],i=s;i<v;i++)x[a][i]=0;if(0!==d){for(p=x[a][a]*d,i=s;i<v;i++){for(u=0,n=s;n<y;n++)u+=x[n][a]*x[n][i];for(l=u/p,n=a;n<y;n++)x[n][i]=x[n][i]+l*x[n][a]}for(i=a;i<y;i++)x[i][a]=x[i][a]/d}else for(i=a;i<y;i++)x[i][a]=0;x[a][a]=x[a][a]+1}for(t*=b,n=v-1;0<=n;n--)for(var A=0;A<50;A++){for(S=!1,s=n;0<=s;s--){if(Math.abs(c[s])<=t){S=!0;break}if(Math.abs(k[s-1])<=t)break}if(!S)for(M=0,h=s-(u=1),a=s;a<n+1&&(l=u*c[a],c[a]=M*c[a],!(Math.abs(l)<=t));a++)if(d=k[a],k[a]=Math.sqrt(l*l+d*d),M=d/(p=k[a]),u=-l/p,f)for(i=0;i<y;i++)w=x[i][h],q=x[i][a],x[i][h]=w*M+q*u,x[i][a]=-w*u+q*M;if(q=k[n],s===n){if(q<0&&(k[n]=-q,o))for(i=0;i<v;i++)m[i][n]=-m[i][n];break}for(b=k[s],l=(((w=k[n-1])-q)*(w+q)+((d=c[n-1])-(p=c[n]))*(d+p))/(2*p*w),d=Math.sqrt(l*l+1),l=((b-q)*(b+q)+p*(w/(l<0?l-d:l+d)-p))/b,a=s+(u=M=1);a<n+1;a++){if(d=c[a],w=k[a],p=u*d,d*=M,q=Math.sqrt(l*l+p*p),l=b*(M=l/(c[a-1]=q))+d*(u=p/q),d=-b*u+d*M,p=w*u,w*=M,o)for(i=0;i<v;i++)b=m[i][a-1],q=m[i][a],m[i][a-1]=b*M+q*u,m[i][a]=-b*u+q*M;if(q=Math.sqrt(l*l+p*p),l=(M=l/(k[a-1]=q))*d+(u=p/q)*w,b=-u*d+M*w,f)for(i=0;i<y;i++)w=x[i][a-1],q=x[i][a],x[i][a-1]=w*M+q*u,x[i][a]=-w*u+q*M}c[s]=0,c[n]=l,k[n]=b}for(a=0;a<v;a++)k[a]<t&&(k[a]=0);return{u:x,q:k,v:m}},r.VERSION="1.0.6",Object.defineProperty(r,"__esModule",{value:!0})});
